<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GPX 3D Flyover</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üó∫Ô∏è</text></svg>">
    <link rel="stylesheet" href="https://unpkg.com/maplibre-gl@4.1.0/dist/maplibre-gl.css">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
    <div class="container">
        <aside class="sidebar">
            <h1>GPX 3D Flyover</h1>

            <!-- Upload Section -->
            <section class="panel">
                <h2>Upload GPX</h2>
                <div class="upload-zone" id="uploadZone">
                    <input type="file" id="gpxInput" accept=".gpx" hidden>
                    <div class="upload-content">
                        <svg viewBox="0 0 24 24" width="48" height="48">
                            <path fill="currentColor" d="M19.35 10.04C18.67 6.59 15.64 4 12 4 9.11 4 6.6 5.64 5.35 8.04 2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96zM14 13v4h-4v-4H7l5-5 5 5h-3z"/>
                        </svg>
                        <p>Drop GPX file here or click to browse</p>
                    </div>
                </div>
                <div id="trackInfo" class="track-info hidden"></div>
            </section>

            <!-- Map Settings -->
            <section class="panel">
                <h2>Map Style</h2>
                <div class="control-group">
                    <label for="mapStyle">Base Map</label>
                    <select id="mapStyle">
                        <option value="esri-satellite">ESRI Satellite</option>
                        <option value="openstreetmap">OpenStreetMap</option>
                        <option value="osm-topo">OpenTopoMap</option>
                    </select>
                </div>
            </section>

            <!-- Animation Settings -->
            <section class="panel">
                <h2>Animation</h2>
                <div class="control-group">
                    <label>Mode</label>
                    <div class="radio-group">
                        <label class="radio-label">
                            <input type="radio" name="animationMode" value="follow" checked>
                            <span>Follow Track</span>
                        </label>
                        <label class="radio-label">
                            <input type="radio" name="animationMode" value="birdseye">
                            <span>Bird's Eye</span>
                        </label>
                    </div>
                </div>
                <div class="control-group">
                    <label for="speed">Speed: <span id="speedValue">1</span>x</label>
                    <input type="range" id="speed" min="0.25" max="15" step="0.25" value="1">
                </div>
                <div class="control-group">
                    <label for="cameraAltitude">Camera Altitude: <span id="altitudeValue">100</span>m</label>
                    <input type="range" id="cameraAltitude" min="20" max="2000" step="10" value="100">
                </div>
                <div class="control-group">
                    <label for="cameraPitch">Camera Pitch: <span id="pitchValue">60</span>¬∞</label>
                    <input type="range" id="cameraPitch" min="0" max="85" step="1" value="60">
                </div>
            </section>

            <!-- Video Settings -->
            <section class="panel">
                <h2>Video Export</h2>
                <div class="control-group">
                    <label for="resolution">Resolution</label>
                    <select id="resolution">
                        <option value="1280x720">720p (1280x720)</option>
                        <option value="1920x1080" selected>1080p (1920x1080)</option>
                        <option value="2560x1440">1440p (2560x1440)</option>
                        <option value="3840x2160">4K (3840x2160)</option>
                        <option value="custom">Custom</option>
                    </select>
                </div>
                <div id="customResolution" class="control-group hidden">
                    <div class="inline-inputs">
                        <input type="number" id="customWidth" placeholder="Width" value="1920" min="640" max="7680">
                        <span>x</span>
                        <input type="number" id="customHeight" placeholder="Height" value="1080" min="480" max="4320">
                    </div>
                </div>
                <div class="control-group">
                    <label for="fps">Frame Rate</label>
                    <select id="fps">
                        <option value="24">24 FPS</option>
                        <option value="30" selected>30 FPS</option>
                        <option value="60">60 FPS</option>
                    </select>
                </div>
                <div class="control-group">
                    <label for="videoFormat">Format</label>
                    <select id="videoFormat">
                        <option value="mp4" selected>MP4 (H.264) - Most Compatible</option>
                        <option value="webm">WebM (VP9) - Smaller Size</option>
                    </select>
                </div>
                <div id="conversionStatus" class="status-text"></div>
            </section>

            <!-- Controls -->
            <section class="panel controls">
                <div class="button-row">
                    <button id="playBtn" class="btn btn-primary" disabled>
                        <svg viewBox="0 0 24 24" width="20" height="20">
                            <path fill="currentColor" d="M8 5v14l11-7z"/>
                        </svg>
                        Play
                    </button>
                    <button id="stopBtn" class="btn" disabled>
                        <svg viewBox="0 0 24 24" width="20" height="20">
                            <path fill="currentColor" d="M6 6h12v12H6z"/>
                        </svg>
                        Stop
                    </button>
                </div>
                <button id="recordBtn" class="btn btn-record" disabled>
                    <svg viewBox="0 0 24 24" width="20" height="20">
                        <circle fill="currentColor" cx="12" cy="12" r="8"/>
                    </svg>
                    Record Video
                </button>
                <div id="progress" class="progress hidden">
                    <div class="progress-bar">
                        <div class="progress-fill" id="progressFill"></div>
                    </div>
                    <span id="progressText">0%</span>
                </div>
            </section>
        </aside>

        <main class="map-container">
            <div id="map"></div>
            <div id="loading" class="loading hidden">
                <div class="spinner"></div>
                <span>Loading...</span>
            </div>
        </main>
    </div>

    <script src="https://unpkg.com/maplibre-gl@4.1.0/dist/maplibre-gl.js"></script>
    <script src="{{ url_for('static', filename='js/map.js') }}"></script>
    <script src="{{ url_for('static', filename='js/animation.js') }}"></script>
    <script src="{{ url_for('static', filename='js/recorder.js') }}"></script>
    <script src="{{ url_for('static', filename='js/main.js') }}"></script>
</body>
</html>
